<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Mouse Shadow</title>
	<link rel="icon" href="https://fav.farm/üî•" />
</head>

<body>

	<div class="hero">
		<h1 contenteditable>üî•WOAH!</h1>
	</div>

	<style>
		html {
			color: black;
			font-family: sans-serif;
		}

		body {
			margin: 0;
		}

		.hero {
			min-height: 100vh;
			display: flex;
			justify-content: center;
			align-items: center;
			color: black;
		}

		h1 {
			text-shadow: 10px 10px 0 rgba(0, 0, 0, 1);
			font-size: 100px;
		}
	</style>

	<script>
		// const hero = document.querySelector('.hero')
		// const text = hero.querySelector('h1')
		// const walk = 500; // 500px

		// function shadow(e) {
		// 	const { offsetWidth: width, offsetHeight: height } = hero
		// 	let { offsetX: x, offsetY: y } = e

		// 	if (this !== e.target) {
		// 		x = x + e.target.offsetLeft
		// 		y = y + e.target.offsetTop
		// 	}

		// 	const xWalk = (x / width * walk) - (walk / 2)
		// 	const yWalk = (y / height * walk) - (walk / 2)

		// 	text.style.textShadow = `
    //   ${xWalk}px ${yWalk}px 0 rgba(255,0,255,0.7),
    //   ${xWalk * -1}px ${yWalk}px 0 rgba(0,255,255,0.7),
    //   ${yWalk}px ${xWalk * -1}px 0 rgba(0,255,0,0.7),
    //   ${yWalk * -1}px ${xWalk}px 0 rgba(0,0,255,0.7)
    // `
		// 	console.log(xWalk, yWalk)
		// }

		// hero.addEventListener('mousemove', shadow)

		// optimal version
		const hero = document.querySelector('.hero');
    const text = hero.querySelector('h1');

    // tunable
    let walk = Number(getComputedStyle(document.documentElement).getPropertyValue('--walk')) || 500;
    const half = () => walk / 2;

    // state
    let rect = hero.getBoundingClientRect();
    let px = 0, py = 0, dirty = false;

    // recalc on resize (a scroll nen√≠ pot≈ôeba, str√°nka je bez posunu)
    addEventListener('resize', () => { rect = hero.getBoundingClientRect(); }, { passive: true });

    // sbƒõr ud√°lost√≠ bez pr√°ce
    hero.addEventListener('pointermove', (e) => {
      px = e.clientX - rect.left;
      py = e.clientY - rect.top;
      dirty = true;
    }, { passive: true });

    // render smyƒçka
    function tick() {
      if (dirty) {
        dirty = false;

        // clamp pro jistotu p≈ôi rychl√©m pohybu mimo box
        const x = Math.max(0, Math.min(px, rect.width));
        const y = Math.max(0, Math.min(py, rect.height));

        const xWalk = (x / rect.width)  * walk - half();
        const yWalk = (y / rect.height) * walk - half();

        // bez zbyteƒçn√Ωch mezer a alokac√≠
        text.style.textShadow =
          `${xWalk}px ${yWalk}px 0 rgba(255,0,255,.7),
           ${-xWalk}px ${yWalk}px 0 rgba(0,255,255,.7),
           ${yWalk}px ${-xWalk}px 0 rgba(0,255,0,.7),
           ${-yWalk}px ${xWalk}px 0 rgba(0,0,255,.7)`;
      }
      requestAnimationFrame(tick);
    }
    requestAnimationFrame(tick);
	</script>
</body>

</html>